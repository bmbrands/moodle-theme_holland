{"version":3,"file":"featurecourse.min.js","sources":["../src/featurecourse.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Feature course toggle button.\n *\n * @module     theme_holland/featurecourse\n * @copyright  2026 Bas Brands <bas@sonsbeekmedia.nl>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport Notification from 'core/notification';\nimport Templates from 'core/templates';\n\nclass FavouriteCourse {\n    constructor(courseid, rootElement) {\n        this.courseid = courseid;\n        this.rootElement = rootElement;\n        this.isfavourite = false;\n        this.hasAccess = false;\n        this.waiting = false;\n    }\n\n    init() {\n        if (!document.body.classList.contains('path-course-view') || !document.body.classList.contains('pagelayout-course')) {\n            return;\n        }\n        this.courseHeader = this.rootElement.querySelector('#page-header-title');\n        this.buttonContainer = document.createElement('div');\n        this.buttonContainer.classList.add('d-inline-block', 'ml-4');\n        // Insert the button container after the course title.\n        this.courseHeader.parentNode.insertBefore(this.buttonContainer, this.courseHeader.nextSibling);\n        this.render();\n        this.addEventListeners();\n    }\n\n    async render() {\n        this.buttonFeatured = await Templates.render('theme_holland/theme/featurebutton', {\n            featured: true,\n            featuring: false\n        }).then((html) => {\n            return html;\n        }).catch(Notification.exception);\n        this.buttonDefault = await Templates.render('theme_holland/theme/featurebutton', {\n            featured: false,\n            featuring: false\n        }).then((html) => {\n            return html;\n        }).catch(Notification.exception);\n        this.buttonWaiting = await Templates.render('theme_holland/theme/featurebutton', {\n            featured: false,\n            featuring: true\n        }).then((html) => {\n            return html;\n        }).catch(Notification.exception);\n\n        await this.favouriteCourse();\n    }\n\n    async renderFeatureButton() {\n        if (!this.hasAccess) {\n            return;\n        }\n        if (this.waiting) {\n            this.buttonContainer.innerHTML = this.buttonWaiting;\n        } else if (this.isfavourite) {\n            this.buttonContainer.innerHTML = this.buttonFeatured;\n        } else {\n            this.buttonContainer.innerHTML = this.buttonDefault;\n        }\n    }\n\n    async addEventListeners() {\n        this.rootElement.addEventListener('click', async(event) => {\n            if (event.target.closest('.btn-feature')) {\n                this.favouriteCourse();\n            }\n        });\n    }\n\n    /**\n     * Set the favourite state of a post.\n     * @return {Promise}\n     */\n    favouriteCourse() {\n        this.waiting = true;\n        this.renderFeatureButton();\n        const data = {\n            courseid: this.courseid,\n            togglestate: this.hasAccess\n        };\n        return Ajax.call([{\n            methodname: 'theme_holland_favourite_course',\n            args: data\n        }])[0].done((response) => {\n            this.isfavourite = response.isfavourite;\n            this.hasAccess = response.hasaccess;\n            this.waiting = false;\n            this.renderFeatureButton();\n            return '';\n        }).catch(Notification.exception);\n    }\n\n}\n\nconst init = (courseid) => {\n    const rootElement = document.querySelector('#page-header');\n    const favouritecourse = new FavouriteCourse(courseid, rootElement);\n    favouritecourse.init();\n};\n\nexport default {\n    init: init\n};\n"],"names":["_interopRequireDefault","e","__esModule","default","_ajax","_notification","_templates","FavouriteCourse","constructor","courseid","rootElement","this","isfavourite","hasAccess","waiting","init","document","body","classList","contains","courseHeader","querySelector","buttonContainer","createElement","add","parentNode","insertBefore","nextSibling","render","addEventListeners","buttonFeatured","Templates","featured","featuring","then","html","catch","Notification","exception","buttonDefault","buttonWaiting","favouriteCourse","renderFeatureButton","innerHTML","addEventListener","async","event","target","closest","data","togglestate","Ajax","call","methodname","args","done","response","hasaccess","_exports"],"mappings":"oJAyBuC,SAAAA,uBAAAC,GAAAA,OAAAA,GAAAA,EAAAC,WAAAD,EAAAE,CAAAA,QAAAF,EAAA;;;;;;;qFAFvCG,MAAAJ,uBAAAI,OACAC,cAAAL,uBAAAK,eACAC,WAAAN,uBAAAM,YAEA,MAAMC,gBACFC,WAAAA,CAAYC,SAAUC,aAClBC,KAAKF,SAAWA,SAChBE,KAAKD,YAAcA,YACnBC,KAAKC,aAAc,EACnBD,KAAKE,WAAY,EACjBF,KAAKG,SAAU,CACnB,CAEAC,IAAAA,GACSC,SAASC,KAAKC,UAAUC,SAAS,qBAAwBH,SAASC,KAAKC,UAAUC,SAAS,uBAG/FR,KAAKS,aAAeT,KAAKD,YAAYW,cAAc,sBACnDV,KAAKW,gBAAkBN,SAASO,cAAc,OAC9CZ,KAAKW,gBAAgBJ,UAAUM,IAAI,iBAAkB,QAErDb,KAAKS,aAAaK,WAAWC,aAAaf,KAAKW,gBAAiBX,KAAKS,aAAaO,aAClFhB,KAAKiB,SACLjB,KAAKkB,oBACT,CAEA,YAAMD,GACFjB,KAAKmB,qBAAuBC,mBAAUH,OAAO,oCAAqC,CAC9EI,UAAU,EACVC,WAAW,IACZC,KAAMC,MACEA,MACRC,MAAMC,cAAYlC,QAACmC,WACtB3B,KAAK4B,oBAAsBR,mBAAUH,OAAO,oCAAqC,CAC7EI,UAAU,EACVC,WAAW,IACZC,KAAMC,MACEA,MACRC,MAAMC,cAAYlC,QAACmC,WACtB3B,KAAK6B,oBAAsBT,mBAAUH,OAAO,oCAAqC,CAC7EI,UAAU,EACVC,WAAW,IACZC,KAAMC,MACEA,MACRC,MAAMC,cAAYlC,QAACmC,iBAEhB3B,KAAK8B,iBACf,CAEA,yBAAMC,GACG/B,KAAKE,YAGNF,KAAKG,QACLH,KAAKW,gBAAgBqB,UAAYhC,KAAK6B,cAC/B7B,KAAKC,YACZD,KAAKW,gBAAgBqB,UAAYhC,KAAKmB,eAEtCnB,KAAKW,gBAAgBqB,UAAYhC,KAAK4B,cAE9C,CAEA,uBAAMV,GACFlB,KAAKD,YAAYkC,iBAAiB,QAASC,cACnCC,MAAMC,OAAOC,QAAQ,iBACrBrC,KAAK8B,mBAGjB,CAMAA,eAAAA,GACI9B,KAAKG,SAAU,EACfH,KAAK+B,sBACL,MAAMO,KAAO,CACTxC,SAAUE,KAAKF,SACfyC,YAAavC,KAAKE,WAEtB,OAAOsC,MAAIhD,QAACiD,KAAK,CAAC,CACdC,WAAY,iCACZC,KAAML,QACN,GAAGM,KAAMC,WACT7C,KAAKC,YAAc4C,SAAS5C,YAC5BD,KAAKE,UAAY2C,SAASC,UAC1B9C,KAAKG,SAAU,EACfH,KAAK+B,sBACE,KACRN,MAAMC,cAAYlC,QAACmC,UAC1B,EAQFoB,SAAAvD,QAEa,CACXY,KAPUN,WACV,MAAMC,YAAcM,SAASK,cAAc,gBACnB,IAAId,gBAAgBE,SAAUC,aACtCK,SAKnB,OAAA2C,SAAAvD,OAAA"}